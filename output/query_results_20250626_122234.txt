Healthcare Data Engineering Project - Query Results
Generated: 2025-06-26 12:22:34
============================================================

QUERY: Query 1: Average age and age range of patients (REQUIRED)
----------------------------------------
Description: Average age and age range of patients (REQUIRED)
Execution Time: 0.01 seconds
Results:
+---------------+-----------+-----------+-------------+------------------+
|   average_age |   min_age |   max_age |   age_range |   total_patients |
+===============+===========+===========+=============+==================+
|         56.64 |        25 |        86 |          61 |              150 |
+---------------+-----------+-----------+-------------+------------------+

QUERY: Query 2: Average patients per physician (REQUIRED)
----------------------------------------
Description: Average patients per physician (REQUIRED)
Execution Time: 0.011 seconds
Results:
+------------------------------+--------------------+----------------------------+
|   avg_patients_per_physician |   total_physicians |   total_patient_encounters |
+==============================+====================+============================+
|                         2.28 |                108 |                        246 |
+------------------------------+--------------------+----------------------------+

QUERY: Query 3: Most common diagnoses by age group with medication correlation
----------------------------------------
Description: Most common diagnoses by age group with medication correlation
Execution Time: 0.017 seconds
Results:
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| age_group   | diagnosis_code   | diagnosis_description                                                     |   diagnosis_count |   patients_with_medications |   medication_rate_percent |
+=============+==================+===========================================================================+===================+=============================+===========================+
| 18-30       | I10              | Essential (primary) hypertension                                          |                 7 |                           6 |                     85.71 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 18-30       | Z00.00           | Encounter for general adult medical examination without abnormal findings |                 4 |                           1 |                     25    |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 18-30       | E11.9            | Type 2 diabetes mellitus without complications                            |                 3 |                           1 |                     33.33 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 18-30       | N39.0            | Urinary tract infection, site not specified                               |                 3 |                           1 |                     33.33 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 31-50       | I10              | Essential (primary) hypertension                                          |                21 |                          17 |                     80.95 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 31-50       | Z00.00           | Encounter for general adult medical examination without abnormal findings |                19 |                           8 |                     42.11 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 31-50       | E11.9            | Type 2 diabetes mellitus without complications                            |                19 |                          14 |                     73.68 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 31-50       | J06.9            | Acute upper respiratory infection, unspecified                            |                10 |                           4 |                     40    |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 31-50       | N39.0            | Urinary tract infection, site not specified                               |                 6 |                           3 |                     50    |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 51-70       | E11.9            | Type 2 diabetes mellitus without complications                            |                25 |                          22 |                     88    |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 51-70       | I10              | Essential (primary) hypertension                                          |                23 |                          18 |                     78.26 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 51-70       | Z00.00           | Encounter for general adult medical examination without abnormal findings |                15 |                           3 |                     20    |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 51-70       | J06.9            | Acute upper respiratory infection, unspecified                            |                11 |                           4 |                     36.36 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| 51-70       | N39.0            | Urinary tract infection, site not specified                               |                11 |                           7 |                     63.64 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| Over 70     | I10              | Essential (primary) hypertension                                          |                26 |                          19 |                     73.08 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| Over 70     | E11.9            | Type 2 diabetes mellitus without complications                            |                15 |                          12 |                     80    |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| Over 70     | Z00.00           | Encounter for general adult medical examination without abnormal findings |                14 |                           4 |                     28.57 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| Over 70     | N39.0            | Urinary tract infection, site not specified                               |                 9 |                           7 |                     77.78 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+
| Over 70     | J06.9            | Acute upper respiratory infection, unspecified                            |                 7 |                           3 |                     42.86 |
+-------------+------------------+---------------------------------------------------------------------------+-------------------+-----------------------------+---------------------------+

QUERY: Query 4: Lab value trends and abnormal results by patient demographics
----------------------------------------
Description: Lab value trends and abnormal results by patient demographics
Execution Time: 0.024 seconds
Results:
+----------------------------------------------------------------------------------------------------------------+
| QUERY PLAN                                                                                                     |
+================================================================================================================+
| Limit  (cost=29.53..29.56 rows=10 width=38) (actual time=0.324..0.326 rows=10 loops=1)                         |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=15                                                                                         |
+----------------------------------------------------------------------------------------------------------------+
| ->  Sort  (cost=29.53..29.66 rows=50 width=38) (actual time=0.323..0.324 rows=10 loops=1)                      |
+----------------------------------------------------------------------------------------------------------------+
| Sort Key: (count(d.diagnosis_id)) DESC                                                                         |
+----------------------------------------------------------------------------------------------------------------+
| Sort Method: top-N heapsort  Memory: 26kB                                                                      |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=15                                                                                         |
+----------------------------------------------------------------------------------------------------------------+
| ->  HashAggregate  (cost=26.57..28.45 rows=50 width=38) (actual time=0.255..0.272 rows=150 loops=1)            |
+----------------------------------------------------------------------------------------------------------------+
| Group Key: p.patient_id                                                                                        |
+----------------------------------------------------------------------------------------------------------------+
| Filter: (count(d.diagnosis_id) > 0)                                                                            |
+----------------------------------------------------------------------------------------------------------------+
| Batches: 1  Memory Usage: 64kB                                                                                 |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=12                                                                                         |
+----------------------------------------------------------------------------------------------------------------+
| ->  Hash Right Join  (cost=14.41..24.80 rows=236 width=54) (actual time=0.139..0.193 rows=289 loops=1)         |
+----------------------------------------------------------------------------------------------------------------+
| Hash Cond: (d.patient_id = p.patient_id)                                                                       |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=12                                                                                         |
+----------------------------------------------------------------------------------------------------------------+
| ->  Seq Scan on diagnoses d  (cost=0.00..7.21 rows=221 width=32) (actual time=0.002..0.016 rows=221 loops=1)   |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=5                                                                                          |
+----------------------------------------------------------------------------------------------------------------+
| ->  Hash  (cost=12.41..12.41 rows=160 width=38) (actual time=0.129..0.130 rows=184 loops=1)                    |
+----------------------------------------------------------------------------------------------------------------+
| Buckets: 1024  Batches: 1  Memory Usage: 21kB                                                                  |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=7                                                                                          |
+----------------------------------------------------------------------------------------------------------------+
| ->  Hash Right Join  (cost=6.38..12.41 rows=160 width=38) (actual time=0.056..0.092 rows=184 loops=1)          |
+----------------------------------------------------------------------------------------------------------------+
| Hash Cond: (m.patient_id = p.patient_id)                                                                       |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=7                                                                                          |
+----------------------------------------------------------------------------------------------------------------+
| ->  Seq Scan on medications m  (cost=0.00..5.60 rows=160 width=32) (actual time=0.002..0.012 rows=160 loops=1) |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=4                                                                                          |
+----------------------------------------------------------------------------------------------------------------+
| ->  Hash  (cost=4.50..4.50 rows=150 width=22) (actual time=0.046..0.046 rows=150 loops=1)                      |
+----------------------------------------------------------------------------------------------------------------+
| Buckets: 1024  Batches: 1  Memory Usage: 17kB                                                                  |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=3                                                                                          |
+----------------------------------------------------------------------------------------------------------------+
| ->  Seq Scan on patients p  (cost=0.00..4.50 rows=150 width=22) (actual time=0.005..0.016 rows=150 loops=1)    |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=3                                                                                          |
+----------------------------------------------------------------------------------------------------------------+
| Planning:                                                                                                      |
+----------------------------------------------------------------------------------------------------------------+
| Buffers: shared hit=90                                                                                         |
+----------------------------------------------------------------------------------------------------------------+
| Planning Time: 0.770 ms                                                                                        |
+----------------------------------------------------------------------------------------------------------------+
| Execution Time: 0.417 ms                                                                                       |
+----------------------------------------------------------------------------------------------------------------+

